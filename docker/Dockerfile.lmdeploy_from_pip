FROM nvidia/cuda:11.7.1-runtime-ubuntu20.04

ARG DEBIAN_FRONTEND=noninteractive

RUN apt update && \
    apt install -y python3.8 python3-distutils && \
    apt install -y build-essential checkinstall zlib1g-dev libssl-dev && \
    apt install -y rapidjson-dev libgoogle-glog-dev gdb vim cmake git-lfs curl

RUN cd /usr/bin && ln -snf python3.8 python
RUN curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py && \
    python3.8 get-pip.py && pip3 install --upgrade pip

RUN python3 -m pip install --no-cache-dir fire==0.5.0
RUN python3 -m pip install --no-cache-dir -i https://pypi.shopee.io/simple/ aip-infer-utils
RUN python3 -m pip install --no-cache-dir lmdeploy

WORKDIR /workspace
